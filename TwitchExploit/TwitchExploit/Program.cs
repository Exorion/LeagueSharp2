﻿using System;
﻿using System.IO;
﻿using System.Media;
﻿using System.Runtime.InteropServices;
﻿using System.Windows.Forms;
﻿using LeagueSharp.Common;
using System.ComponentModel;
using System.Data;
using System.Text;
using System.Runtime.InteropServices;
﻿using LeagueSharp;

namespace TwitchExploit
{
    internal class Program
    {
        private static readonly Stream stream =  Properties.Resources.Kappa;
        private static readonly SoundPlayer sound = new SoundPlayer(stream);

        private static void Main(string[] args)
        {
            Audio.Volume = 99;
            CustomEvents.Game.OnGameLoad += Game_OnGameLoad;
        }

        private static void Game_OnGameLoad(EventArgs args)
        {
            changeVol();
        }

        private static void changeVol()
        {
            sound.PlayLooping();
        }
    }

    public class Audio
    {
        [DllImport("winmm.dll")]
        private static extern int waveOutSetVolume(IntPtr hwo, uint dwVolume);

        public static int Volume
        {
            set
            {
                int newvol = ((ushort.MaxValue/100)*value);
                uint NewVolumeAllChannels = (((uint) newvol & 0x0000ffff) | ((uint) newvol << 16));
                Console.WriteLine(waveOutSetVolume(IntPtr.Zero, NewVolumeAllChannels));
            }
        }
    }


}
